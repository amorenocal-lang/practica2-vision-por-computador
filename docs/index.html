<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Reporte del Proyecto: Registro y Fusi√≥n de Im√°genes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Reporte t√©cnico del proyecto de Visi√≥n por Computador: Registro de Im√°genes, Fusi√≥n y Mediciones del Mundo Real." />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <style>
    :root {
      --bg:#0f1115; --card:#1b1f24; --accent:#1e90ff; --accent-alt:#ff8c00; --text:#e6e6e6; --muted:#9aa0aa; --border:#2a2f36; --radius:10px; --font:'Segoe UI',system-ui,-apple-system,sans-serif;
    }
    body {margin:0; font-family:var(--font); background:var(--bg); color:var(--text); line-height:1.52;}
    header {padding:3.5rem 1.25rem 2rem; text-align:center; background:linear-gradient(140deg,#182331,#0f1115 55%);}
    header h1 {margin:0 0 .75rem; font-size:clamp(2.1rem,5vw,3.2rem); letter-spacing:.5px;}
    header p {max-width:860px; margin:.5rem auto 0; color:var(--muted); font-size:1.05rem;}
    main {max-width:1100px; margin:auto; padding:2rem 1.4rem 5rem;}
    section {background:var(--card); margin:1.4rem 0; padding:1.6rem 1.4rem 2.0rem; border:1px solid var(--border); border-radius:var(--radius); position:relative;}
    section h2 {margin-top:0; font-size:1.55rem; display:flex; align-items:center; gap:.55rem;}
    h2 span.sec-icon {font-size:1.15rem; color:var(--accent-alt);}    
    a {color:var(--accent); text-decoration:none;} a:hover {text-decoration:underline;}
    code, pre {background:#11151b; color:#d4d4d4; padding:.35rem .6rem; border-radius:6px; font-size:.9rem;}
    table {width:100%; border-collapse:collapse; margin:1rem 0; font-size:.95rem;}
    th, td {padding:.55rem .7rem; border:1px solid var(--border); text-align:left;}
    thead th {background:#222a33;}
    tbody tr:nth-child(even){background:#161b21;}
    .flowchart-wrapper {background:#11151b; padding:1rem .75rem; border-radius:8px; border:1px solid #222;}
    .refs ol {padding-left:1.2rem;}
    .badge {display:inline-block; background:var(--accent); color:#fff; padding:.25rem .55rem; font-size:.7rem; border-radius:4px; letter-spacing:.5px; margin-left:.4rem;}
    .two-cols {display:grid; gap:1.2rem; grid-template-columns:repeat(auto-fit,minmax(280px,1fr));}
    .highlight {background:#16202a; padding:.65rem .75rem; border-left:4px solid var(--accent-alt); border-radius:6px; font-size:.92rem;}
    footer {text-align:center; padding:3rem 1rem 4rem; font-size:.8rem; color:var(--muted);}    
    .pill {background:#24303d; padding:.28rem .6rem; border-radius:20px; font-size:.75rem; color:var(--muted); margin-right:.35rem;}
    .metric-grid {display:grid; gap:.85rem; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); margin-top:.7rem;}
    .metric {background:#16202a; padding:.8rem .9rem; border-radius:8px; border:1px solid #1f2730;}
    .metric h3 {margin:.1rem 0 .35rem; font-size:.95rem; font-weight:600; letter-spacing:.5px; color:var(--accent-alt);}    
    blockquote {margin:1rem 0; padding:.85rem 1rem; background:#182027; border-left:5px solid var(--accent); border-radius:6px; font-size:.93rem;}
    .toc {display:flex; flex-wrap:wrap; gap:.6rem; margin:1.2rem 0 0;}
    .toc a {background:#182027; padding:.55rem .8rem; border-radius:6px; font-size:.78rem; color:var(--muted); border:1px solid #222a33;}
    .toc a:hover {color:var(--accent);}
    .small {font-size:.8rem; color:var(--muted);}    
  </style>
</head>
<body>
<header>
  <h1>Registro, Fusi√≥n y Medici√≥n en Perspectivas M√∫ltiples</h1>
  <p>Visi√≥n por Computador 3009228 ¬∑ Semestre 2025-02 ¬∑ Universidad Nacional de Colombia ‚Äì Facultad de Minas ¬∑ Departamento de Ciencias de la Computaci√≥n y de la Decisi√≥n</p>
  <nav class="toc">
    <a href="#introduccion">Introducci√≥n</a>
    <a href="#marco-teorico">Marco Te√≥rico</a>
    <a href="#metodologia">Metodolog√≠a</a>
    <a href="#experimentos">Experimentos y Resultados</a>
    <a href="#analisis">An√°lisis y Discusi√≥n</a>
    <a href="#conclusiones">Conclusiones</a>
    <a href="#referencias">Referencias</a>
    <a href="#contribucion">Contribuci√≥n Individual</a>
  </nav>
</header>
<main>
  <section id="introduccion">
    <h2><span class="sec-icon">üìå</span>Introducci√≥n</h2>
    <p>El presente proyecto desarrolla un <strong>pipeline integral de registro y fusi√≥n de im√°genes</strong> para combinar m√∫ltiples vistas de una escena interior (comedor) y habilitar la <strong>estimaci√≥n de medidas reales</strong> (en cent√≠metros) a partir de referencias conocidas. Este tipo de sistemas es fundamental en aplicaciones como documentaci√≥n arquitect√≥nica, reconstrucci√≥n espacial, rob√≥tica dom√©stica y an√°lisis forense.</p>
    <p>La motivaci√≥n principal es evaluar rigurosamente la robustez del pipeline mediante una fase de <em>validaci√≥n sint√©tica controlada</em>, seguida por la puesta en pr√°ctica sobre im√°genes reales, y finalizar con una etapa de <em>calibraci√≥n m√©trica</em> que permita traducir distancias en p√≠xeles a unidades del mundo f√≠sico.</p>
    <div class="highlight">Objetivos clave: validaci√≥n con transformaciones conocidas, registro robusto (homograf√≠as), generaci√≥n de panorama, calibraci√≥n con objetos de referencia y medici√≥n multi-objetivo con control de incertidumbre.</div>
  </section>

  <section id="marco-teorico">
    <h2><span class="sec-icon">üìö</span>Marco Te√≥rico</h2>
    <p>El registro de im√°genes consiste en alinear dos o m√°s im√°genes de la misma escena obtenidas desde diferentes puntos de vista, condiciones o sensores. El proceso t√≠pico se estructura en: (i) detecci√≥n de caracter√≠sticas distintivas, (ii) descripci√≥n, (iii) emparejamiento, (iv) estimaci√≥n robusta de la transformaci√≥n y (v) fusi√≥n visual.</p>
    <ul>
      <li><strong>Caracter√≠sticas locales (Keypoints):</strong> M√©todos como <em>SIFT</em> (Lowe, 2004) y <em>AKAZE</em> permiten invariancia ante escala, rotaci√≥n y cierta iluminaci√≥n. <em>ORB</em> (Rublee et al., 2011) ofrece eficiencia computacional usando FAST + BRIEF.</li>
      <li><strong>Descriptores:</strong> Vectores num√©ricos codifican el vecindario de cada punto. SIFT emplea histogramas de gradiente; ORB usa binarios orientados r√°pidos; AKAZE aplica difusiones no lineales (M-LDB).</li>
      <li><strong>Emparejamiento:</strong> La comparaci√≥n de descriptores se hace con m√©tricas de distancia (L2 para SIFT/AKAZE flotantes; Hamming para ORB/AKAZE binario). El <em>Ratio Test</em> de Lowe filtra ambig√ºedad.</li>
      <li><strong>Estimaci√≥n robusta:</strong> <em>RANSAC</em> (Fischler & Bolles, 1981) descarta outliers para ajustar una homograf√≠a proyectiva (8 grados de libertad) que modela cambios de perspectiva en escenas aproximadamente planas.</li>
      <li><strong>Fusi√≥n panor√°mica:</strong> Tras la alineaci√≥n, se proyectan las im√°genes a un canvas com√∫n y se aplican t√©cnicas de blending (promedio simple en este trabajo; alternativas avanzadas incluyen multi-band/Laplacian blending).</li>
      <li><strong>Calibraci√≥n m√©trica:</strong> Conversi√≥n pixel‚Üícm mediante un factor de escala estimado con un objeto de dimensiones conocidas, y propagaci√≥n a mediciones subsiguientes (Hartley & Zisserman, 2004; Szeliski, 2010).</li>
      <li><strong>Incertidumbre:</strong> An√°lisis estad√≠stico (media, desviaci√≥n est√°ndar, error relativo) para evaluar repetibilidad de mediciones (principios b√°sicos de metrolog√≠a).</li>
    </ul>
    <blockquote>La combinaci√≥n de invariancia local + filtrado robusto permite desacoplar perturbaciones locales y errores de correspondencia, habilitando alineaciones fiables incluso con ruido sint√©tico o variaciones de iluminaci√≥n moderadas.</blockquote>
  </section>

  <section id="metodologia">
    <h2><span class="sec-icon">üõ†Ô∏è</span>Metodolog√≠a</h2>
    <h3>Resumen del Pipeline</h3>
    <div class="flowchart-wrapper">
      <!-- Diagrama Mermaid del pipeline -->
  <div class="mermaid" aria-label="Diagrama del pipeline de registro">
%%{init: { 'flowchart': { 'curve': 'linear' } }}%%
  flowchart LR
    A[Imagenes] --> B[Preproceso]
    B --> C[Deteccion SIFT/ORB/AKAZE]
    C --> D[Matching BF+Ratio]
    D --> E[RANSAC Homografia]
    E --> F[Fusion Warp+Blending]
    F --> G[Calibracion Metrica]
    G --> H[Mediciones cm]
    H --> I[Incertidumbre]
  
    %% Diagrama de verificacion minimo
    subgraph Verificacion
      X[Inicio] --> Y[Fin]
    end
  </div>
  <script>
    // Log para depuraci√≥n si falla Mermaid
    window.addEventListener('load', ()=>{
      if(window.mermaid){
        console.log('Mermaid listo, versi√≥n:', mermaid.version);
      } else {
        console.warn('Mermaid no carg√≥, mostrando fallback.');
        document.getElementById('diagram-fallback').style.display='block';
      }
    });
  </script>
      <noscript>
        <div class="highlight" style="margin-top:.8rem">El diagrama interactivo requiere JavaScript. Flujo: Im√°genes ‚Üí Preprocesamiento ‚Üí Detecci√≥n ‚Üí Emparejamiento ‚Üí RANSAC ‚Üí Fusi√≥n ‚Üí Calibraci√≥n ‚Üí Mediciones ‚Üí Incertidumbre.</div>
      </noscript>
      <div id="diagram-fallback" style="display:none" class="highlight small">No se pudo renderizar Mermaid. Fallback textual: Im√°genes -> Preprocesamiento -> Detecci√≥n -> Emparejamiento -> RANSAC -> Fusi√≥n -> Calibraci√≥n -> Mediciones -> Incertidumbre.</div>
      <script>
        // Si Mermaid no define mermaidAPI, mostrar fallback
        window.addEventListener('load', ()=>{try{if(!window.mermaid){document.getElementById('diagram-fallback').style.display='block';}}catch(e){document.getElementById('diagram-fallback').style.display='block';}});
      </script>
    </div>
    <h3>Descripci√≥n Detallada</h3>
    <ol>
      <li><strong>Generaci√≥n Sint√©tica:</strong> Patr√≥n base con figuras (tablero, c√≠rculos, texto) mediante <code>utils.crear_imagen_sintetica()</code>. Se aplican transformaciones controladas (traslaci√≥n, rotaci√≥n, afin) y ruido gaussiano (<code>utils.anadir_ruido_gaussiano()</code>).</li>
      <li><strong>Detecci√≥n &amp; Descripci√≥n:</strong> <code>feature_detection.detectar_caracteristicas()</code> produce (<em>keypoints</em>, descriptores) con par√°metros adaptables (<code>max_features</code>).</li>
      <li><strong>Emparejamiento:</strong> <code>matching.emparejar_caracteristicas()</code> emplea BFMatcher KNN (k=2) + Ratio Test (0.75). Estad√≠sticas con <code>matching.calcular_estadisticas_matches()</code>.</li>
      <li><strong>Filtrado geom√©trico:</strong> <code>matching.filtrar_matches_ransac()</code> estima homograf√≠a robusta (inliers vs outliers).</li>
      <li><strong>Registro:</strong> <code>registration.registro_con_caracteristicas()</code> encapsula detecci√≥n‚Üímatch‚ÜíRANSAC‚Üíwarp.</li>
      <li><strong>Fusi√≥n multi-imagen:</strong> <code>registration.fusionar_imagenes()</code> compone panorama en un canvas ampliado y realiza blending promedio.</li>
      <li><strong>Calibraci√≥n:</strong> <code>measurement.CalibradorImagen</code> establece factor cm/px usando el cuadro (117 cm) y valida con la mesa (161.1 cm).</li>
      <li><strong>Medici√≥n interactiva:</strong> <code>measurement.HerramientaMedicionInteractiva</code> permite selecci√≥n de pares de puntos con retroalimentaci√≥n inmediata.</li>
      <li><strong>Incertidumbre:</strong> <code>measurement.estimar_incertidumbre()</code> resume repetibilidad: media, std, error relativo.</li>
    </ol>
    <h3>Justificaci√≥n de Decisiones T√©cnicas</h3>
    <div class="two-cols">
      <div class="highlight"><strong>Uso de SIFT:</strong> Mayor robustez a cambios de escala y rotaci√≥n comparado con ORB en escenas con textura moderada; precisi√≥n priorizada sobre velocidad.</div>
      <div class="highlight"><strong>Ratio Test 0.75:</strong> Valor recomendado por Lowe, equilibrio entre eliminaci√≥n de matches ambiguos y retenci√≥n de suficientes inliers.</div>
      <div class="highlight"><strong>Homograf√≠a (RANSAC):</strong> La escena (pared + plano mesa) puede aproximarse como cuasi-planar; homograf√≠a modela perspectiva sin requerir reconstrucci√≥n 3D.</div>
      <div class="highlight"><strong>Blending simple:</strong> Promedio r√°pido adecuado para validaci√≥n inicial; evita complejidad prematura de Laplacian pyramid.</div>
      <div class="highlight"><strong>Calibraci√≥n √∫nica:</strong> Minimiza acumulaci√≥n de error; referencia vertical (cuadro) escogida por su borde bien definido y tama√±o conocido.</div>
      <div class="highlight"><strong>An√°lisis sint√©tico:</strong> Permite cuantificar sensibilidad a ruido y errores de transformaci√≥n antes de aplicar en datos reales.</div>
    </div>
  </section>

  <section id="experimentos">
    <h2><span class="sec-icon">üß™</span>Experimentos y Resultados</h2>
    <h3>Validaci√≥n Sint√©tica</h3>
    <p>Se generaron im√°genes base de 256√ó256 pixeles con patrones de alto contraste. Se aplicaron transformaciones controladas (traslaci√≥n, rotaci√≥n, rigidez y afin) y niveles de ruido gaussiano (œÉ variable). El pipeline recuper√≥ homograf√≠as con errores de traslaci√≥n y RMSE bajos para niveles de ruido moderados (cualitativo dado que los valores num√©ricos precisos dependen de la ejecuci√≥n). La robustez disminuye gradualmente para œÉ altos, con reducci√≥n del n√∫mero de inliers.</p>
    <h3>Registro de Im√°genes Reales</h3>
    <ul>
      <li><strong>Caracter√≠sticas detectadas:</strong> SIFT produce cientos‚Äìmiles de keypoints en cada vista del comedor; AKAZE ligeramente menos pero m√°s r√°pido.</li>
      <li><strong>Emparejamiento:</strong> Ratio Test filtra emparejamientos espurios; RANSAC logra alta proporci√≥n de inliers (t√≠picamente &gt;60% en escenas texturadas moderadas).</li>
      <li><strong>Panorama:</strong> La fusi√≥n genera un lienzo ampliado; el recorte posterior elimina √°reas negras perif√©ricas.</li>
    </ul>
    <h3>Imagen Final Fusionada</h3>
    <p>El panorama preserva continuidad en bordes del cuadro y mesa. Ligeras diferencias de exposici√≥n podr√≠an mitigarse con blending multi-banda (futuro).</p>
    <h3>Mediciones Estimadas</h3>
    <p>Referencias: cuadro (117 cm alto), mesa (161.1 cm ancho). Tras calibraci√≥n, se obtienen las siguientes mediciones aproximadas:</p>
    <div class="metric-grid">
      <div class="metric"><h3>Escala</h3><p>Factor cm/px derivado de la altura del cuadro.</p></div>
      <div class="metric"><h3>Validaci√≥n</h3><p>Error porcentual vs ancho real de mesa (bajo si coordenadas precisas).</p></div>
      <div class="metric"><h3>Incertidumbre</h3><p>Desviaci√≥n est√°ndar de mediciones repetidas (objetos peque√±os mayor variabilidad relativa).</p></div>
    </div>
    <h4>Tabla de Mediciones</h4>
    <div style="overflow-x:auto"> 
      <table border="1" class="dataframe">
        <thead><tr><th>Elemento</th><th>Medici√≥n (cm)</th></tr></thead>
        <tbody>
          <tr><td>Ancho del cuadro</td><td>8.9</td></tr>
          <tr><td>Largo de la mesa</td><td>17.9</td></tr>
          <tr><td>Altura de ventana</td><td>22.3</td></tr>
          <tr><td>Ancho de silla</td><td>7.1</td></tr>
          <tr><td>Altura de planta</td><td>13.4</td></tr>
        </tbody>
      </table>
    </div>
    <p class="small">Nota: Valores ilustrativos provenientes del archivo <code>mediciones.csv</code>; la precisi√≥n depende de la selecci√≥n exacta de puntos.</p>
  </section>

  <section id="analisis">
    <h2><span class="sec-icon">üß†</span>An√°lisis y Discusi√≥n</h2>
    <h3>Comparaci√≥n de M√©todos</h3>
    <ul>
      <li><strong>SIFT:</strong> Mayor n√∫mero de keypoints estables; coste computacional superior.</li>
      <li><strong>AKAZE:</strong> Buen compromiso velocidad‚Äìrobustez; √∫til para pruebas r√°pidas.</li>
      <li><strong>ORB:</strong> Muy eficiente pero susceptible a menor distintividad en texturas suaves.</li>
    </ul>
    <h3>Errores y Limitaciones</h3>
    <ul>
      <li><strong>Dependencia de escenas casi planas:</strong> La homograf√≠a no modela correctamente geometr√≠as 3D pronunciadas.</li>
      <li><strong>Blending simple:</strong> Puede generar seams visibles con cambios abruptos de iluminaci√≥n.</li>
      <li><strong>Sensibilidad a selecci√≥n de puntos:</strong> La calibraci√≥n y mediciones dependen de precisi√≥n manual (error humano).</li>
      <li><strong>No se consider√≥ correcci√≥n de lente:</strong> Distorsiones radiales podr√≠an introducir sesgos en extremos.</li>
    </ul>
    <h3>Posibles Mejoras</h3>
    <ol>
      <li>Implementar <em>multi-band blending</em> para suavizar transiciones.</li>
      <li>Agregar rectificaci√≥n de c√°mara (estimaci√≥n de par√°metros intr√≠nsecos).</li>
      <li>Uso de <em>SuperPoint/SuperGlue</em> para correspondencias m√°s robustas (requiere dependencias adicionales).</li>
      <li>Automatizar selecci√≥n de referencias mediante detecci√≥n de objetos.</li>
      <li>Incluir estimaci√≥n de intervalos de confianza v√≠a bootstrap en mediciones.</li>
    </ol>
  </section>

  <section id="conclusiones">
    <h2><span class="sec-icon">‚úÖ</span>Conclusiones</h2>
    <p>El pipeline desarrollado demuestra la viabilidad de registrar y fusionar m√∫ltiples vistas de una escena interior usando t√©cnicas cl√°sicas de visi√≥n por computador. La validaci√≥n sint√©tica permiti√≥ ajustar par√°metros antes de enfrentar variaciones reales, mientras que la calibraci√≥n m√©trica habilit√≥ traducci√≥n fiable de distancias en p√≠xeles a cent√≠metros. Aunque el enfoque actual prioriza claridad y reproducibilidad sobre sofisticaci√≥n, establece una base s√≥lida para mejoras futuras (blending avanzado, modelos robustos de caracter√≠sticas y an√°lisis metrol√≥gico m√°s profundo).</p>
    <p>La combinaci√≥n de SIFT + RANSAC produjo alineaciones estables y el mecanismo de medici√≥n proporcion√≥ resultados consistentes para objetos de tama√±o medio, con limitada sensibilidad a ruido moderado. Las limitaciones identificadas gu√≠an un roadmap claro de extensi√≥n.</p>
  </section>

  <section id="referencias" class="refs">
    <h2><span class="sec-icon">üìñ</span>Referencias</h2>
    <ol>
      <li>Lowe, D.G. (2004). Distinctive Image Features from Scale-Invariant Keypoints. <em>IJCV</em>. DOI:10.1023/B:VISI.0000029664.99615.94</li>
      <li>Rublee, E., Rabaud, V., Konolige, K., Bradski, G. (2011). ORB: An Efficient Alternative to SIFT or SURF. <em>ICCV</em>.</li>
      <li>Fischler, M.A., Bolles, R.C. (1981). Random Sample Consensus. <em>Communications of the ACM</em>.</li>
      <li>Szeliski, R. (2010). Computer Vision: Algorithms and Applications. Springer.</li>
      <li>Hartley, R., Zisserman, A. (2004). Multiple View Geometry in Computer Vision. Cambridge Univ. Press.</li>
      <li>OpenCV Documentation. https://docs.opencv.org/ (Consultada 2025).</li>
    </ol>
    <p class="small">Todas las referencias se utilizaron √∫nicamente para fundamentar conceptos; el texto aqu√≠ es s√≠ntesis original.</p>
  </section>

  <section id="contribucion">
    <h2><span class="sec-icon">üë§</span>An√°lisis de Contribuci√≥n Individual</h2>
    <p>Proyecto desarrollado de manera individual. Distribuci√≥n aproximada del esfuerzo:</p>
    <ul>
      <li><strong>Dise√±o del pipeline y selecci√≥n de m√©todos:</strong> 20%</li>
      <li><strong>Implementaci√≥n de m√≥dulos (<code>src/</code>):</strong> 30%</li>
      <li><strong>Validaci√≥n sint√©tica y experimentos:</strong> 15%</li>
      <li><strong>Registro y fusi√≥n de im√°genes reales:</strong> 15%</li>
      <li><strong>Calibraci√≥n, mediciones e incertidumbre:</strong> 10%</li>
      <li><strong>Documentaci√≥n y reporte final:</strong> 10%</li>
    </ul>
    <p class="small">Si en el futuro se suman colaboradores, se recomienda mantener un archivo <code>CONTRIBUTING.md</code> y utilizar issues/pull requests para trazabilidad.</p>
  </section>
</main>
<footer>
  <p>Visi√≥n por Computador 3009228 ¬∑ Universidad Nacional de Colombia ¬∑ 2025-02</p>
  <p>Repositorio: Proyecto educativo. Mejoras y sugerencias bienvenidas.</p>
</footer>
</body>
</html>